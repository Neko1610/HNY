<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Happy New Year 2026</title>
<style>
html,body{
  margin:0;
  padding:0;
  overflow:hidden;
  background:black;
  font-family:monospace;
}
canvas{ position:fixed; inset:0; }

/* START */
#startBtn{
  position:fixed; inset:0;
  display:flex; align-items:center; justify-content:center;
  background:black; color:#00ff99;
  font-size:3rem; cursor:pointer;
  text-shadow:0 0 25px #00ff99;
  z-index:50;
}

/* COUNTDOWN */
#countdown{
  position:fixed; inset:0;
  display:flex; align-items:center; justify-content:center;
  pointer-events:none; z-index:20;
}
.matrix{
  display:grid;
  grid-template-columns:repeat(7,32px);
  gap:8px;
}
.cell{
  width:32px; height:32px;
  display:flex; align-items:center; justify-content:center;
  font-size:42px;
  color:white;
  opacity:0.15;
}
.cell.on{
  opacity:1;
  text-shadow:0 0 18px white;
}

/* MERGE TEXT */
#mergeText{
  position:fixed; inset:0;
  display:flex; align-items:center; justify-content:center;
  font-size:4.5rem;
  color:white;
  text-shadow:0 0 40px orange;
  pointer-events:none;
  z-index:25;
}
.merge-char{
  position:absolute;
  opacity:0;
}

/* WISH */
#wish{
  position:fixed;
  top:50%; left:50%;
  transform:translate(-50%,-50%) scale(0.8);
  font-size:2.2rem;
  color:#ffd700;
  text-shadow:0 0 30px orange;
  opacity:0;
  transition:0.8s;
  z-index:30;
  text-align:center;
}
</style>
</head>

<body>

<div id="startBtn">B·∫ÆT ƒê·∫¶U</div>

<canvas id="matrix"></canvas>
<div id="countdown"></div>
<div id="mergeText"></div>

<canvas id="c"></canvas>
<div id="wish"></div>

<script>
/* ================= BASIC ================= */
const isMobile=/Android|iPhone|iPad/i.test(navigator.userAgent);
const DPR=isMobile?1:Math.min(devicePixelRatio,2);
const chars="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

/* ================= MATRIX ================= */
const mCanvas=document.getElementById("matrix");
const mCtx=mCanvas.getContext("2d");
let matrixRunning=false;

function resizeMatrix(){
  mCanvas.width=innerWidth*DPR;
  mCanvas.height=innerHeight*DPR;
  mCtx.setTransform(DPR,0,0,DPR,0,0);
}
resizeMatrix();

const fontSize=14;
let cols,rows;
function updateGrid(){
  cols=Math.floor(innerWidth/fontSize);
  rows=Math.floor(innerHeight/fontSize);
}
updateGrid();

function drawMatrix(){
  if(!matrixRunning) return;
  mCtx.fillStyle="rgba(0,0,0,0.35)";
  mCtx.fillRect(0,0,innerWidth,innerHeight);
  mCtx.font=fontSize+"px monospace";
  for(let y=0;y<rows;y++){
    for(let x=0;x<cols;x++){
      if(Math.random()<0.05){
        mCtx.fillStyle="#00ff99";
        mCtx.fillText(
          chars[Math.random()*chars.length|0],
          x*fontSize,y*fontSize
        );
      }
    }
  }
}
setInterval(drawMatrix,60);

/* ================= COUNTDOWN ================= */
const numbers={
3:["0111110","0000011","0011110","0000011","0111110"],
2:["0111110","0000011","0111110","0110000","0111111"],
1:["0011000","0111000","0011000","0011000","0111110"]
};

let cellTimer;
function showNumber(n){
  const cd=document.getElementById("countdown");
  cd.innerHTML="";
  const grid=document.createElement("div");
  grid.className="matrix";
  numbers[n].forEach(r=>{
    r.split("").forEach(b=>{
      const c=document.createElement("div");
      c.className="cell"+(b==="1"?" on":"");
      c.textContent=chars[Math.random()*chars.length|0];
      grid.appendChild(c);
    });
  });
  cd.appendChild(grid);
  clearInterval(cellTimer);
  cellTimer=setInterval(()=>{
    grid.querySelectorAll(".cell").forEach(c=>{
      c.textContent=chars[Math.random()*chars.length|0];
    });
  },80);
}

/* ================= MERGE TEXT ================= */
function showMergeText(){
  return new Promise(res=>{
    const text="HAPPY NEW YEAR 2026";
    const box=document.getElementById("mergeText");
    box.innerHTML="";
    const cx=innerWidth/2, cy=innerHeight/2;
    [...text].forEach((ch,i)=>{
      const s=document.createElement("span");
      s.className="merge-char";
      s.textContent=ch;
      s.style.left=Math.random()*innerWidth+"px";
      s.style.top=Math.random()*innerHeight+"px";
      box.appendChild(s);
      setTimeout(()=>{
        s.style.transition="1.5s";
        s.style.left=cx-text.length*16+i*32+"px";
        s.style.top=cy+"px";
        s.style.opacity=1;
      },i*70);
    });
    setTimeout(()=>{ box.innerHTML=""; res(); },3500);
  });
}

/* ================= FIREWORK ================= */
const c=document.getElementById("c");
const ctx=c.getContext("2d");
function resizeFire(){
  c.width=innerWidth*DPR;
  c.height=innerHeight*DPR;
  ctx.setTransform(DPR,0,0,DPR,0,0);
}
resizeFire();

let particles=[], rockets=[], started=false;

class Particle{
  constructor(x,y,strong=false){
    const a=Math.random()*Math.PI*2;
    const s=strong?Math.random()*4+4:Math.random()*2+2;
    this.vx=Math.cos(a)*s;
    this.vy=Math.sin(a)*s;
    this.x=x; this.y=y;
    this.life=strong?140:100;
    this.color=`hsl(${Math.random()*360},100%,70%)`;
  }
  update(){
    this.x+=this.vx;
    this.y+=this.vy;
    this.vy+=0.04;
    this.life--;
    ctx.fillStyle=this.color;
    ctx.beginPath();
    ctx.arc(this.x,this.y,2.2,0,Math.PI*2);
    ctx.fill();
    return this.life>0;
  }
}

function explodeHeart(x,y){
  for(let t=0;t<Math.PI*2;t+=0.18){
    const r=10*(1-Math.sin(t));
    particles.push(new Particle(
      x+r*Math.cos(t),
      y-r*Math.sin(t),
      true
    ));
  }
}

function explodeStar(x,y){
  for(let i=0;i<10;i++){
    const a=Math.PI*2/5*i;
    particles.push(new Particle(
      x+Math.cos(a)*18,
      y+Math.sin(a)*18
    ));
  }
  setTimeout(()=>{
    for(let i=0;i<(isMobile?20:50);i++)
      particles.push(new Particle(x,y,true));
  },200);
}

class Rocket{
  constructor(){
    this.x=Math.random()*innerWidth;
    this.y=innerHeight;
    this.vy=-(Math.random()*4+7);
    this.target=Math.random()*innerHeight*0.4+80;
  }
  update(){
    this.y+=this.vy;
    this.vy+=0.05;
    ctx.fillStyle="white";
    ctx.fillRect(this.x,this.y,2,2);
    if(this.y<=this.target){
      const r=Math.random();
      if(r<0.3) explodeHeart(this.x,this.y);
      else if(r<0.6) explodeStar(this.x,this.y);
      else for(let i=0;i<(isMobile?35:80);i++)
        particles.push(new Particle(this.x,this.y,true));
      showWish();
      return false;
    }
    return true;
  }
}

let last=0;
function loop(t){
  const limit=isMobile?40:16;
  if(t-last<limit){ requestAnimationFrame(loop); return; }
  last=t;
  if(started){
    ctx.fillStyle="rgba(0,0,0,0.25)";
    ctx.fillRect(0,0,innerWidth,innerHeight);
    if(rockets.length<(isMobile?1:4)&&Math.random()<0.02)
      rockets.push(new Rocket());
    rockets=rockets.filter(r=>r.update());
    particles=particles.filter(p=>p.update());
  }
  requestAnimationFrame(loop);
}
requestAnimationFrame(loop);

/* ================= WISH ================= */
const wishes=[
"üéâ Ch√∫c m·ª´ng nƒÉm m·ªõi 2026 üéâ",
"üå∏ An khang ‚Äì Th·ªãnh v∆∞·ª£ng üå∏",
"üí∞ Ti·ªÅn v√¥ nh∆∞ n∆∞·ªõc üí∞",
"‚ù§Ô∏è Gia ƒë√¨nh lu√¥n h·∫°nh ph√∫c ‚ù§Ô∏è",
"üöÄ S·ª± nghi·ªáp thƒÉng hoa üöÄ",
"‚ú® M·ªçi ƒëi·ªÅu nh∆∞ √Ω ‚ú®",
"üéØ M·ª•c ti√™u n√†o c≈©ng ƒë·∫°t üéØ",
"üçÄ May m·∫Øn c·∫£ nƒÉm üçÄ",
"üî• ƒêam m√™ r·ª±c ch√°y üî•",
"üìà Th√†nh c√¥ng v∆∞·ª£t b·∫≠c üìà",
"üòÑ Lu√¥n vui v·∫ª üòÑ",
"üéÅ Nhi·ªÅu ni·ªÅm vui üéÅ",
"üèÜ Chi·∫øn th·∫Øng m·ªçi th·ª≠ th√°ch üèÜ",
"üåà Cu·ªôc s·ªëng r·ª±c r·ª° üåà",
"üíñ Y√™u th∆∞∆°ng tr·ªçn v·∫πn üíñ",
"üß† H·ªçc g√¨ c≈©ng nhanh üß†",
"üí™ S·ª©c kh·ªèe d·ªìi d√†o üí™",
"üïäÔ∏è B√¨nh an m·ªói ng√†y üïäÔ∏è",
"üéä NƒÉm m·ªõi b√πng n·ªï üéä",
"ü•Ç Happy New Year 2026 ü•Ç"
];
let wi=0,showing=false;
function showWish(){
  if(showing) return;
  showing=true;
  const w=document.getElementById("wish");
  w.textContent=wishes[wi++%wishes.length];
  w.style.opacity=1;
  w.style.transform="translate(-50%,-50%) scale(1)";
  setTimeout(()=>{
    w.style.opacity=0;
    w.style.transform="translate(-50%,-50%) scale(0.8)";
    showing=false;
  },2500);
}

/* ================= FLOW ================= */
document.getElementById("startBtn").onclick=async()=>{
  document.getElementById("startBtn").style.display="none";
  matrixRunning=true;
  let seq=[3,2,1],i=0;
  const t=setInterval(async()=>{
    if(i<seq.length) showNumber(seq[i++]);
    else{
      clearInterval(t);
      document.getElementById("countdown").innerHTML="";
      await showMergeText();
      matrixRunning=false;
      mCtx.clearRect(0,0,innerWidth,innerHeight);
      started=true;
    }
  },1000);
};

window.onresize=()=>{
  resizeMatrix(); updateGrid(); resizeFire();
};
</script>

</body>
</html>
